{"version":3,"sources":["webpack://_N_E/./pages/connector.js","webpack://_N_E/./node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?8f2b"],"names":["__jsx","createElement","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","prototype","toString","call","e","_isNativeReflectConstruct","result","Super","NewTarget","this","constructor","arguments","apply","isNilOrEmpty","str","length","styles","mainPadding","padding","mainSidePadding","mainPdf","display","justifyContent","mainTable","backgroundColor","border","borderRadius","boxShadow","position","backButton","cusor","label","fontWeight","langs","en","heading","apiSection","title","style","description","target","href","succsess","fail","placeholder","show","contactSection","typeSection","deleteDialog","cancel","confirm","header","message","x","concat","types","nl","Connector","_React$Component","_super","_this","microsoftTeams","initialize","state","apiKey","adminId","admins","admin","contacts","contact","loadingContacts","keys","isNew","isOpen","isContactsOpen","locale","tabType","showApiKeys","loaded","forHours","forInvoices","forQuotes","addWebhookToMoneybird","bind","setUpWebhook","deleteKeyFromDb","createKeyEntry","getAdmin","getOptions","getContacts","getAdminAndContacts","updateContact","key","value","_componentDidMount","mark","_callee3","_this2","wrap","_context3","prev","next","window","getContext","_ref","_callee2","context","tid","res","json","_context2","fetch","mode","method","sent","console","log","map","k","content","cursor","onClick","setState","deleteKey","_callee","_context","stop","t0","_x","_this$state","urlParam","events","push","join","_getAdminAndContacts","_callee4","_context4","_x2","_ref3","_this3","_getContacts","_callee5","v","_this$state2","q","_res","_json","_context5","searchQuery","body","JSON","stringify","path","save","_x3","_x4","_addWebhookToMoneybird","_callee6","webhook","_this$state3","contactId","lang","_context6","split","data","url","abrupt","_x5","_x6","_x7","_x8","_getAdmin","_callee7","_args7","_context7","undefined","error","id","_x9","_setUpWebhook","_callee9","_this4","_context9","settings","setValidityState","registerOnSaveHandler","saveEvent","teamId","channelId","forTypes","getForDataTypes","notifyFailure","entityId","setSettings","contentUrl","configName","getSettings","_ref4","_callee8","webhookUrl","encoded","_context8","exec","encodeURIComponent","notifySuccess","_x11","_x10","_deleteKeyFromDb","_callee10","_this$state4","_context10","filter","_this5","handleToken","c","company_name","_this6","_this$state5","src","rel","theme","gap","vAlign","hAlign","width","Fragment","background","color","marginTop","marginBottom","items","onOpenChange","name","clearable","fluid","search","open","itemToString","i","onSearchQueryChange","noResultsMessage","m","active","ref","r","drop","loading","loadingMessage","onChange","disabled","checked","cancelButton","onCancel","confirmButton","onConfirm","backdrop","Component","__NEXT_P"],"mappings":"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","file":"static/chunks/pages/connector-2b77baa587b7b5177042.js","sourcesContent":["import _toConsumableArray from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jp/Documents/teams-moneybird-interface/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport { Provider, teamsTheme, Flex, FlexItem, Dropdown, RadioGroup, Header, Label, Checkbox, Dialog } from '@fluentui/react-northstar';\nimport Head from 'next/head';\n\nvar isNilOrEmpty = function isNilOrEmpty(str) {\n  return str == null || str.length == 0;\n};\n\nvar styles = {\n  mainPadding: {\n    padding: \"0px 2em\"\n  },\n  mainSidePadding: {\n    padding: \"10px 2em\"\n  },\n  mainPdf: {\n    display: \"flex\",\n    justifyContent: \"center\"\n  },\n  mainTable: {\n    backgroundColor: \"#fff\",\n    border: \"1px solid #d8e2f0\",\n    borderRadius: \"4px\",\n    boxShadow: \"0 0 10px 0 rgba(19,29,41,.05)\",\n    position: \"relative\",\n    padding: \"0em 3em 2em\"\n  },\n  backButton: {\n    cusor: \"pointer\"\n  },\n  label: {\n    fontWeight: \"bold\"\n  }\n};\nvar langs = {\n  en: {\n    heading: \"Moneybird Configuration\",\n    apiSection: {\n      title: __jsx(\"label\", {\n        style: styles.label\n      }, \"API Token\"),\n      description: __jsx(\"span\", null, \"This is the API Token for you MoneyBird Account. You can generate one \", __jsx(\"a\", {\n        target: \"_blank\",\n        href: \"https://moneybird.com/user/applications/new\"\n      }, \"here\"), \" for personal use.\"),\n      succsess: \"API Token is vaild\",\n      fail: \"API Token NOT vaild\",\n      placeholder: 'API Token',\n      show: \"Click to choose another api key\"\n    },\n    contactSection: {\n      title: __jsx(\"label\", {\n        style: styles.label\n      }, \"Contact\"),\n      description: __jsx(\"span\", null, \"The contact whos data will show up on the tab\"),\n      placeholder: 'Choose a Contact'\n    },\n    typeSection: {\n      title: __jsx(\"label\", {\n        style: styles.label\n      }, \"Data Type\"),\n      description: __jsx(\"span\", null, \"The types of data to show notifcations for\")\n    },\n    deleteDialog: {\n      cancel: \"Cancel\",\n      confirm: \"Yes\",\n      header: \"Delete API Key\",\n      message: function message(x) {\n        return \"Are you sure you want to delete \".concat(x);\n      }\n    },\n    types: [\"Invoices\", \"Quotes\", \"Hours\"]\n  },\n  nl: {\n    heading: \"Moneybird Koppelen\",\n    apiSection: {\n      title: __jsx(\"label\", {\n        style: styles.label\n      }, \"API token invoeren\"),\n      description: __jsx(\"span\", null, \"Vul hier een API-token in van je Moneybird account. Je kunt \", __jsx(\"a\", {\n        target: \"_blank\",\n        href: \"https://moneybird.com/user/applications/new\"\n      }, \"hier\"), \" een API-token genereren. Vul een naam in die herkenbaar is voor deze connectie, bijvoorbeeld \\u2018Microsoft Teams Integratie\\u2019. Kies voor \\u2018API token voor persoonlijk gebruik\\u2019 en geef toegang voor alle onderdelen. Vervolgens verschijnt er een API-token in beeld. Vul deze hieronder in.\"),\n      succsess: \"API-token is geldig\",\n      fail: \"API-token niet geldig\",\n      placeholder: 'API token invoeren',\n      show: \"Klik om een ​​andere API-sleutel te kiezen\"\n    },\n    contactSection: {\n      title: __jsx(\"label\", {\n        style: styles.label\n      }, \"Contact\"),\n      description: __jsx(\"span\", null, \"Selecteer de Contact waarvan je de gegevens wilt tonen in de Tab.\"),\n      placeholder: \"Kies een Contact\"\n    },\n    typeSection: {\n      title: __jsx(\"label\", {\n        style: styles.label\n      }, \"Data Type\"),\n      description: __jsx(\"span\", null, \"Het type gegevens dat op het tabblad moet worden weergegeven\")\n    },\n    deleteDialog: {\n      cancel: \"Annuleren\",\n      confirm: \"Ja\",\n      header: \"API-sleutel verwijderen\",\n      message: function message(x) {\n        return \"Weet je zeker dat je wilt verwijderen \".concat(x);\n      }\n    },\n    types: [\"Facturen\", \"Offertes\", \"Uren\"]\n  }\n};\n\nvar Connector = /*#__PURE__*/function (_React$Component) {\n  _inherits(Connector, _React$Component);\n\n  var _super = _createSuper(Connector);\n\n  function Connector() {\n    var _this;\n\n    _classCallCheck(this, Connector);\n\n    _this = _super.call(this);\n    if (_this.microsoftTeams) _this.microsoftTeams.initialize();\n    _this.state = {\n      apiKey: \"\",\n      adminId: null,\n      admins: null,\n      admin: null,\n      contacts: null,\n      contact: null,\n      loadingContacts: false,\n      keys: [],\n      isNew: false,\n      isOpen: false,\n      isContactsOpen: false,\n      locale: null,\n      tabType: \"invoices\",\n      showApiKeys: false,\n      loaded: false,\n      forHours: false,\n      forInvoices: false,\n      forQuotes: false\n    };\n    _this.addWebhookToMoneybird = _this.addWebhookToMoneybird.bind(_assertThisInitialized(_this));\n    _this.setUpWebhook = _this.setUpWebhook.bind(_assertThisInitialized(_this));\n    _this.deleteKeyFromDb = _this.deleteKeyFromDb.bind(_assertThisInitialized(_this));\n    _this.createKeyEntry = _this.createKeyEntry.bind(_assertThisInitialized(_this));\n    _this.getAdmin = _this.getAdmin.bind(_assertThisInitialized(_this));\n    _this.getOptions = _this.getOptions.bind(_assertThisInitialized(_this));\n    _this.getContacts = _this.getContacts.bind(_assertThisInitialized(_this));\n    _this.getAdminAndContacts = _this.getAdminAndContacts.bind(_assertThisInitialized(_this));\n    _this.updateContact = _this.updateContact.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Connector, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var _this2 = this;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                /*const  tid = \"3e2156e8-2679-455b-b3f0-458173a8190b\";\n                const locale = \"en-us\";    \n                 try{\n                    const res = await fetch(\n                        `https://moneybirdhandlerproxy.azurewebsites.net/api/key/${tid}`,\n                        {\n                            mode:\"cors\",\n                            method:\"GET\"\n                        }\n                    )\n                    const json = await res.json()\n                    console.log({json})\n                    const keys = json.map(k=>({\n                        content: <div>\n                            <span \n                                style={{cursor:\"pointer\"}} \n                                class=\"lnr lnr-trash\" \n                                onClick={()=>this.setState({deleteKey:k.key, isOpen:false})}></span> - <span style={{cursor:\"pointer\"}} onClick={async ()=>{await this.getAdminAndContacts(k.key)}}>{k.key}</span>\n                        </div>,\n                        key: k.key\n                    }));\n                    console.log({keys})\n                    this.setState({keys, tid, locale})\n                 }\n                catch(e){\n                    console.log(\"BOO\")\n                    console.log(e)\n                }*/\n                this.microsoftTeams = window ? window.microsoftTeams : null;\n                this.microsoftTeams.initialize();\n                this.microsoftTeams.getContext( /*#__PURE__*/function () {\n                  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(context) {\n                    var tid, locale, res, json, keys;\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            tid = context.tid, locale = context.locale;\n                            _context2.prev = 1;\n                            _context2.next = 4;\n                            return fetch(\"https://moneybirdproxymaatwerk.azurewebsites.net/api/key/\".concat(tid), {\n                              mode: \"cors\",\n                              method: \"GET\"\n                            });\n\n                          case 4:\n                            res = _context2.sent;\n                            _context2.next = 7;\n                            return res.json();\n\n                          case 7:\n                            json = _context2.sent;\n                            console.log({\n                              json: json\n                            });\n                            keys = json.map(function (k) {\n                              return {\n                                content: __jsx(\"div\", null, __jsx(\"span\", {\n                                  style: {\n                                    cursor: \"pointer\"\n                                  },\n                                  \"class\": \"lnr lnr-trash\",\n                                  onClick: function onClick() {\n                                    return _this2.setState({\n                                      deleteKey: k.key,\n                                      isOpen: false\n                                    });\n                                  }\n                                }), \" - \", __jsx(\"span\", {\n                                  style: {\n                                    cursor: \"pointer\"\n                                  },\n                                  onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                                      while (1) {\n                                        switch (_context.prev = _context.next) {\n                                          case 0:\n                                            _context.next = 2;\n                                            return _this2.getAdminAndContacts(k.key);\n\n                                          case 2:\n                                          case \"end\":\n                                            return _context.stop();\n                                        }\n                                      }\n                                    }, _callee);\n                                  }))\n                                }, k.key)),\n                                key: k.key\n                              };\n                            });\n                            console.log({\n                              keys: keys\n                            });\n\n                            _this2.setState({\n                              keys: keys,\n                              tid: tid,\n                              locale: locale\n                            });\n\n                            _context2.next = 18;\n                            break;\n\n                          case 14:\n                            _context2.prev = 14;\n                            _context2.t0 = _context2[\"catch\"](1);\n                            console.log(\"BOO\");\n                            console.log(_context2.t0);\n\n                          case 18:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2, null, [[1, 14]]);\n                  }));\n\n                  return function (_x) {\n                    return _ref.apply(this, arguments);\n                  };\n                }().bind(this));\n\n              case 3:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"getForDataTypes\",\n    value: function getForDataTypes() {\n      var _this$state = this.state,\n          forInvoices = _this$state.forInvoices,\n          forQuotes = _this$state.forQuotes,\n          forHours = _this$state.forHours;\n      var urlParam = [];\n      var events = [];\n\n      if (forInvoices) {\n        urlParam.push(\"i\");\n        events.push(\"sales_invoice_created\");\n      }\n\n      if (forQuotes) {\n        urlParam.push(\"q\");\n        events.push(\"estimate_created\");\n      }\n\n      if (forHours) {\n        urlParam.push(\"h\");\n        events.push(\"time_entry_created\");\n        events.push(\"time_entry_updated\");\n      }\n\n      return {\n        urlParam: urlParam.join(\"-\"),\n        events: events\n      };\n    }\n  }, {\n    key: \"getAdminAndContacts\",\n    value: function () {\n      var _getAdminAndContacts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(apiKey) {\n        var adminId;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.getAdmin(apiKey);\n\n              case 2:\n                adminId = _context4.sent;\n                _context4.next = 5;\n                return this.getContacts();\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getAdminAndContacts(_x2) {\n        return _getAdminAndContacts.apply(this, arguments);\n      }\n\n      return getAdminAndContacts;\n    }()\n  }, {\n    key: \"updateContact\",\n    value: function updateContact(e, _ref3) {\n      var _this3 = this;\n\n      var value = _ref3.value;\n      var apiKey = this.state.apiKey;\n      this.setState({\n        contact: value\n      }, function () {\n        return _this3.setUpWebhook(apiKey);\n      });\n    }\n  }, {\n    key: \"getContacts\",\n    value: function () {\n      var _getContacts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(v, e) {\n        var _this$state2, apiKey, adminId, q, res, json, _res, _json;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _this$state2 = this.state, apiKey = _this$state2.apiKey, adminId = _this$state2.adminId;\n\n                if (!e) {\n                  _context5.next = 21;\n                  break;\n                }\n\n                q = e.searchQuery;\n                _context5.prev = 3;\n                this.setState({\n                  loadingContacts: true\n                });\n                _context5.next = 7;\n                return fetch(\"https://moneybirdproxymaatwerk.azurewebsites.net/api/MoneyBirdProxy\", {\n                  mode: \"cors\",\n                  method: \"POST\",\n                  body: JSON.stringify({\n                    method: \"GET\",\n                    path: \"\".concat(adminId, \"/contacts.json\").concat(isNilOrEmpty(q) ? '' : \"?query=\" + q),\n                    key: apiKey\n                  })\n                });\n\n              case 7:\n                res = _context5.sent;\n                _context5.next = 10;\n                return res.json();\n\n              case 10:\n                json = _context5.sent;\n                console.log({\n                  json: json\n                });\n                this.setState({\n                  contacts: json,\n                  loadingContacts: false\n                });\n                _context5.next = 19;\n                break;\n\n              case 15:\n                _context5.prev = 15;\n                _context5.t0 = _context5[\"catch\"](3);\n                console.log(\"BOOM!\");\n                console.log(_context5.t0);\n\n              case 19:\n                _context5.next = 33;\n                break;\n\n              case 21:\n                if (!v) {\n                  _context5.next = 25;\n                  break;\n                }\n\n                this.setState({\n                  contact: v.value\n                }, this.save);\n                _context5.next = 33;\n                break;\n\n              case 25:\n                _context5.next = 27;\n                return fetch(\"https://moneybirdproxymaatwerk.azurewebsites.net/api/MoneyBirdProxy\", {\n                  mode: \"cors\",\n                  method: \"POST\",\n                  body: JSON.stringify({\n                    method: \"GET\",\n                    path: \"\".concat(adminId, \"/contacts.json\"),\n                    key: apiKey\n                  })\n                });\n\n              case 27:\n                _res = _context5.sent;\n                _context5.next = 30;\n                return _res.json();\n\n              case 30:\n                _json = _context5.sent;\n                console.log({\n                  json: _json\n                });\n                this.setState({\n                  contacts: _json,\n                  isOpen: false\n                });\n\n              case 33:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[3, 15]]);\n      }));\n\n      function getContacts(_x3, _x4) {\n        return _getContacts.apply(this, arguments);\n      }\n\n      return getContacts;\n    }()\n  }, {\n    key: \"addWebhookToMoneybird\",\n    value: function () {\n      var _addWebhookToMoneybird = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(apiKey, adminId, webhook, events) {\n        var _this$state3, locale, contact, contactId, lang, res;\n\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _this$state3 = this.state, locale = _this$state3.locale, contact = _this$state3.contact;\n                contactId = contact.value;\n                console.log(\"AHHHHHHH!!!\");\n                console.log({\n                  events: events\n                });\n                console.log({\n                  locale: locale\n                });\n                console.log({\n                  contactId: contactId\n                });\n                console.log(\"https://moneybirdproxymaatwerk.azurewebsites.net/api/teams/\".concat(lang, \"/\").concat(events.urlParam, \"/\").concat(contactId, \"/\").concat(webhook));\n                lang = locale ? locale.split(\"-\")[0] : \"en\";\n                _context6.next = 10;\n                return fetch(\"https://moneybirdproxymaatwerk.azurewebsites.net/api/MoneyBirdProxy\", {\n                  mode: \"cors\",\n                  method: \"POST\",\n                  body: JSON.stringify({\n                    method: \"POST\",\n                    path: \"\".concat(adminId, \"/webhooks.json\"),\n                    key: apiKey,\n                    data: {\n                      url: \"https://moneybirdproxymaatwerk.azurewebsites.net/api/teams/\".concat(lang, \"/\").concat(events.urlParam, \"/\").concat(contactId, \"/\").concat(webhook),\n                      events: events.events\n                    }\n                  })\n                });\n\n              case 10:\n                res = _context6.sent;\n                console.log(\"AHHHHHHH!!!\");\n                _context6.next = 14;\n                return res.json();\n\n              case 14:\n                return _context6.abrupt(\"return\", _context6.sent);\n\n              case 15:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function addWebhookToMoneybird(_x5, _x6, _x7, _x8) {\n        return _addWebhookToMoneybird.apply(this, arguments);\n      }\n\n      return addWebhookToMoneybird;\n    }()\n  }, {\n    key: \"getAdmin\",\n    value: function () {\n      var _getAdmin = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(apiKey) {\n        var isNew,\n            res,\n            json,\n            _args7 = arguments;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                isNew = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : false;\n                _context7.prev = 1;\n                _context7.next = 4;\n                return fetch(\"https://moneybirdproxymaatwerk.azurewebsites.net/api/MoneyBirdProxy\", {\n                  mode: \"cors\",\n                  method: \"POST\",\n                  body: JSON.stringify({\n                    method: \"GET\",\n                    path: \"administrations.json\",\n                    key: apiKey\n                  })\n                });\n\n              case 4:\n                res = _context7.sent;\n                _context7.next = 7;\n                return res.json();\n\n              case 7:\n                json = _context7.sent;\n\n                if (!json.error) {\n                  _context7.next = 12;\n                  break;\n                }\n\n                this.setState({\n                  admins: false,\n                  isOpen: false,\n                  contacts: null\n                });\n                _context7.next = 14;\n                break;\n\n              case 12:\n                this.setState({\n                  admin: json[0],\n                  adminId: json[0].id,\n                  admins: true\n                });\n                return _context7.abrupt(\"return\", json[0].id);\n\n              case 14:\n                _context7.next = 19;\n                break;\n\n              case 16:\n                _context7.prev = 16;\n                _context7.t0 = _context7[\"catch\"](1);\n                console.log(_context7.t0);\n\n              case 19:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this, [[1, 16]]);\n      }));\n\n      function getAdmin(_x9) {\n        return _getAdmin.apply(this, arguments);\n      }\n\n      return getAdmin;\n    }()\n  }, {\n    key: \"setUpWebhook\",\n    value: function () {\n      var _setUpWebhook = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(v) {\n        var _this4 = this;\n\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                this.setState({\n                  apiKey: v,\n                  isOpen: false\n                });\n                console.log(\"SETUPWEBHOOK\");\n                this.microsoftTeams.settings.setValidityState(true);\n                console.log(\"saved\");\n                this.microsoftTeams.settings.registerOnSaveHandler(function (saveEvent) {\n                  console.log(\"REGISTERSAVEHANDLER\");\n\n                  _this4.microsoftTeams.getContext(function (context) {\n                    console.log(\"GETCONTEXT\");\n                    var teamId = context.teamId,\n                        channelId = context.channelId;\n\n                    var forTypes = _this4.getForDataTypes();\n\n                    if (isNilOrEmpty(forTypes.urlParam)) {\n                      saveEvent.notifyFailure(\"Must select a event type to recive notifcations\");\n                      return;\n                    }\n\n                    var contentUrl = \"https://jp5525.github.io/teams-moneybird-interface/connector\";\n                    var entityId = \"connector-moneybird-\".concat(teamId, \"-\").concat(channelId);\n\n                    _this4.microsoftTeams.settings.setSettings({\n                      contentUrl: contentUrl,\n                      entityId: entityId,\n                      configName: \"Moneybird\"\n                    });\n\n                    _this4.microsoftTeams.settings.getSettings( /*#__PURE__*/function () {\n                      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(settings) {\n                        var webhookUrl, res, encoded, adminId, webhook;\n                        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                          while (1) {\n                            switch (_context8.prev = _context8.next) {\n                              case 0:\n                                webhookUrl = settings.webhookUrl;\n                                res = /webhook\\/(.*)/.exec(webhookUrl);\n                                encoded = encodeURIComponent(res[1]);\n                                console.log({\n                                  webhookUrl: webhookUrl\n                                });\n                                _context8.next = 6;\n                                return _this4.getAdmin(v);\n\n                              case 6:\n                                adminId = _context8.sent;\n                                _context8.next = 9;\n                                return _this4.addWebhookToMoneybird(v, adminId, encodeURIComponent(encoded), forTypes);\n\n                              case 9:\n                                webhook = _context8.sent;\n                                console.log({\n                                  webhook: webhook\n                                });\n                                saveEvent.notifySuccess();\n\n                              case 12:\n                              case \"end\":\n                                return _context8.stop();\n                            }\n                          }\n                        }, _callee8);\n                      }));\n\n                      return function (_x11) {\n                        return _ref4.apply(this, arguments);\n                      };\n                    }());\n                  }.bind(_this4));\n                }.bind(this));\n\n              case 5:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function setUpWebhook(_x10) {\n        return _setUpWebhook.apply(this, arguments);\n      }\n\n      return setUpWebhook;\n    }()\n  }, {\n    key: \"deleteKeyFromDb\",\n    value: function () {\n      var _deleteKeyFromDb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n        var _this$state4, deleteKey, keys;\n\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _this$state4 = this.state, deleteKey = _this$state4.deleteKey, keys = _this$state4.keys;\n\n                if (isNilOrEmpty(deleteKey)) {\n                  _context10.next = 5;\n                  break;\n                }\n\n                _context10.next = 4;\n                return fetch(\"https://moneybirdproxymaatwerk.azurewebsites.net/api/key/\".concat(deleteKey), {\n                  mode: \"cors\",\n                  method: \"DELETE\"\n                });\n\n              case 4:\n                this.setState({\n                  deleteKey: null,\n                  apiKey: \"\",\n                  keys: keys.filter(function (x) {\n                    return x.key != deleteKey;\n                  })\n                });\n\n              case 5:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function deleteKeyFromDb() {\n        return _deleteKeyFromDb.apply(this, arguments);\n      }\n\n      return deleteKeyFromDb;\n    }()\n  }, {\n    key: \"createKeyEntry\",\n    value: function createKeyEntry(k) {\n      var _this5 = this;\n\n      return {\n        content: __jsx(\"div\", null, __jsx(\"span\", {\n          style: {\n            cursor: \"pointer\"\n          },\n          \"class\": \"lnr lnr-trash\",\n          onClick: function onClick() {\n            return _this5.setState({\n              deleteKey: k\n            });\n          }\n        }), \" - \", __jsx(\"span\", {\n          style: {\n            cursor: \"pointer\"\n          },\n          onClick: function onClick() {\n            return _this5.handleToken(k);\n          }\n        }, k)),\n        key: k\n      };\n    }\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      var contacts = this.state.contacts;\n      return contacts.map(function (c) {\n        return {\n          content: c.company_name,\n          value: c.id\n        };\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var _this$state5 = this.state,\n          contacts = _this$state5.contacts,\n          contact = _this$state5.contact,\n          admins = _this$state5.admins,\n          admin = _this$state5.admin,\n          apiKey = _this$state5.apiKey,\n          keys = _this$state5.keys,\n          isOpen = _this$state5.isOpen,\n          locale = _this$state5.locale,\n          loadingContacts = _this$state5.loadingContacts,\n          showApiKeys = _this$state5.showApiKeys,\n          deleteKey = _this$state5.deleteKey,\n          forHours = _this$state5.forHours,\n          forInvoices = _this$state5.forInvoices,\n          forQuotes = _this$state5.forQuotes;\n      console.log({\n        locale: locale\n      });\n      var lang = locale ? langs[locale.split(\"-\")[0]] : null;\n      return __jsx(\"div\", null, __jsx(Head, null, __jsx(\"script\", {\n        src: \"https://statics.teams.cdn.office.net/sdk/v1.6.0/js/MicrosoftTeams.min.js\"\n      }), __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://cdn.linearicons.com/free/1.0.0/icon-font.min.css\"\n      })), lang ? __jsx(Provider, {\n        theme: teamsTheme\n      }, __jsx(\"div\", {\n        style: styles.mainPadding\n      }, __jsx(\"div\", {\n        style: styles.mainTable\n      }, __jsx(Header, {\n        content: lang.heading\n      }), __jsx(Flex, {\n        gap: \"gap.small\",\n        vAlign: \"center\",\n        hAlign: \"start\"\n      }, __jsx(FlexItem, {\n        justifyContent: \"center\"\n      }, __jsx(\"form\", {\n        style: {\n          width: \"100%\"\n        }\n      }, lang.apiSection.title, \" \", __jsx(\"br\", null), lang.apiSection.description, admins == false ? __jsx(React.Fragment, null, \" \", __jsx(\"br\", null), __jsx(Label, {\n        content: lang.apiSection.fail,\n        style: {\n          background: \"#cc4a31\",\n          color: \"white\",\n          marginTop: \"10px\",\n          marginBottom: \"10px\"\n        }\n      })) : null, admins ? __jsx(React.Fragment, null, \" \", __jsx(\"br\", null), __jsx(Label, {\n        content: lang.apiSection.succsess,\n        style: {\n          background: \"#7fba00\",\n          color: \"white\",\n          marginTop: \"10px\",\n          marginBottom: \"10px\"\n        }\n      })) : null, __jsx(Dropdown, {\n        items: keys,\n        placeholder: lang.apiSection.placeholder,\n        onOpenChange: function onOpenChange() {\n          return _this6.setState({\n            isOpen: !isOpen\n          });\n        },\n        name: \"apiKey\",\n        id: \"apiKey\",\n        clearable: apiKey && apiKey.length > 0,\n        fluid: true,\n        search: true,\n        open: isOpen,\n        searchQuery: apiKey,\n        itemToString: function itemToString(i) {\n          return i ? i.key : \"\";\n        },\n        onSearchQueryChange: function onSearchQueryChange(e, v) {\n          return _this6.setState({\n            apiKey: v.searchQuery\n          });\n        },\n        noResultsMessage: {\n          content: \"Add... \".concat(apiKey),\n          onClick: function onClick(m) {\n            _this6.setState({\n              isNew: true,\n              keys: [_this6.createKeyEntry(apiKey)].concat(_toConsumableArray(keys)),\n              isOpen: false\n            });\n          },\n          style: {\n            cursor: \"pointer\"\n          },\n          active: true\n        }\n      }), __jsx(\"br\", null), lang.contactSection.title, \" \", __jsx(\"br\", null), lang.contactSection.description, __jsx(Dropdown, {\n        ref: function ref(r) {\n          return _this6.drop = r;\n        },\n        items: contacts ? this.getOptions() : [],\n        value: contact ? contact.content : null,\n        placeholder: lang.contactSection.placeholder,\n        search: true,\n        loading: loadingContacts,\n        loadingMessage: \"Loading...\",\n        onSearchQueryChange: this.getContacts,\n        onChange: this.updateContact,\n        name: \"contact\",\n        disabled: contacts ? false : true,\n        itemToString: function itemToString(i) {\n          return i ? i.content : '';\n        },\n        fluid: true\n      }), __jsx(\"br\", null), lang.typeSection.title, \" \", __jsx(\"br\", null), lang.typeSection.description, \" \", __jsx(\"br\", null), __jsx(Checkbox, {\n        label: lang.types[0],\n        checked: forInvoices,\n        onChange: function onChange() {\n          return _this6.setState({\n            forInvoices: !forInvoices\n          });\n        }\n      }), __jsx(Checkbox, {\n        label: lang.types[1],\n        checked: forQuotes,\n        onChange: function onChange() {\n          return _this6.setState({\n            forQuotes: !forQuotes\n          });\n        }\n      }), __jsx(Checkbox, {\n        label: lang.types[2],\n        checked: forHours,\n        onChange: function onChange() {\n          return _this6.setState({\n            forHours: !forHours\n          });\n        }\n      }), __jsx(Dialog, {\n        cancelButton: lang.deleteDialog.cancel,\n        onCancel: function onCancel() {\n          return _this6.setState({\n            deleteKey: null\n          });\n        },\n        confirmButton: lang.deleteDialog.confirm,\n        onConfirm: this.deleteKeyFromDb,\n        content: lang.deleteDialog.message(deleteKey),\n        header: lang.deleteDialog.header,\n        open: !isNilOrEmpty(deleteKey),\n        backdrop: true\n      }))))))) : null);\n    }\n  }]);\n\n  return Connector;\n}(React.Component);\n\nexport default Connector;","\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/connector\",\n        function () {\n          return require(\"private-next-pages/connector.js\");\n        }\n      ]);\n    "],"sourceRoot":""}